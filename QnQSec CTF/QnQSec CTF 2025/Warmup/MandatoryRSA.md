# QnQSec CTF 2025 — Mandatory RSA
- **Category:** Crypto
- **Tags:** RSA, Wiener's Attack, Factoring, Python

---

## 1. Challenge Summary

The challenge provided the three basic parameters of RSA: modulus `n`, public exponent `e`, and ciphertext `c` in a text file. The task was to decrypt `c` to find the flag.

- Desc: "Size of the D doesn't matter, it's how you use it that counts...”
- Author: Nuts

---

## 2. Initial Analysis & Reconnaissance

I was provided with the values for `n`, `e`, and `c`. The first step was to attempt to factor `n` into two prime numbers `p` and `q` using Factordb, which is a standard method for simple RSA problems. However, `n` was quite large, and Factordb was unable to find the factors.

```
[*] Attempting to factor n: 30610867131545893573245403370929044810375908252345734515216335567761070674235240557970829245356614030481955825874376565524126172250295479286829004996105122106474627414932278394880727207687247106535964451736524423676062227917939094755601312619938974463767105253817030590414646900543888347805544511989816392901347341338737906837896070023751031260815782973250734600300683094949304509692321753534435264794596296780586539085130232106649876660029506699244567866816756904364396378546670735017278059889632347338673055259053699246622809620909022329749464060132071464884484682112534813343645706384624586841979729464134335809829
[-] Failed to find two prime factors for n from Factordb.

```

---

## 3. The Vulnerability

When `n` cannot be easily factored by common methods, we 
need to consider other weaknesses in RSA key generation. With a very 
large public exponent (`e`) as provided, this often indicates a small private exponent (`d`). This is a classic scenario for **Wiener's Attack**, an RSA attack technique based on continued fractions to find `d` when `d` is small (ref: `4_Aurelinth_CRYPTO.md` (Section: C_Attack_RSA)).

---

## 4. Exploitation Steps

1. Initially, `n` factoring was attempted using Factordb but was unsuccessful.
2. Given the large `n` and also a very large `e`, the hypothesis was that `d` might be small, which is a condition for Wiener's Attack.
3. Instead of attempting manual coding or using `RsaCtfTool` (which encountered a path error), an online RSA decryption tool at `dcode.fr` was utilized.
4. The values `N`, `E`, and `C` were input into the `dcode.fr` website.
5. The tool automatically identified and successfully applied Wiener's Attack. It computed `p` and `q` from `N` and `E`, and subsequently found `D`.
6. Finally, `dcode.fr` used `C`, `D`, `N` to decrypt the message, revealing the flag.

---

## 5. Final Exploit / Payload

**Input Parameters:**

- `n =
30610867131545893573245403370929044810375908252345734515216335567761070674235240557970829245356614030481955825874376565524126172250295479286829004996105122106474627414932278394880727207687247106535964451736524423676062227917939094755601312619938974463767105253817030590414646900543888347805544511989816392901347341338737906837896070023751031260815782973250734600300683094949304509692321753534435264794596296780586539085130232106649876660029506699244567866816756904364396378546670735017278059889632347338673055259053699246622809620909022329749464060132071464884484682112534813343645706384624586841979729464134335809829`
- `e =
13118943056376811531390887158969590633018246393862457649378429529040458860386531667701783962295691727349409639660447099510339788107269491122926716426902195188489126034970976454948883089008820188515413336458510467289740954821973897752400562551402417627328759394493013110177705814518809291916661933709921311243284600780240090861401353930215487292827235572235250164436683130292475464090785626013810206032736933354696930489144983575446495078404329829091193678240029445525658582548485531996972340914370823232033916046942293331266006647674886928834212203547468218609381456317192256524737280398698305720035095438106008915543`
- `c =
18491889164810617543569456750416875989184817880137548014973592642069416208831086398288449741333647958301433206462225905089767171227296166302076329585813204145393998300807912284373441125769784091235480355305999860836226228064817001671079683866140595167104080925862489688205706558563994071054217252661751197090938128540101902284587959897970686920835999487758527543265902558413502613239565915919268373782402562042295965144636399280059309987259722405692758942811072888497222424752062745376152606372092707679048892146955016482797824514120865462676167840311292744307891590740707933408465096337716317714272609074408402855672`

<img width="1179" height="602" alt="image" src="https://github.com/user-attachments/assets/08ecef6d-6180-4f4e-92d7-9383c491f833" />

**Flag:**`QnQSec{I_l0v3_Wi3n3r5_@nD_i_l0v3_Nut5!!!!}`

---

## 6. Key Takeaways & Lessons Learned

- **Not always `n` factoring:** When `n` is too large or cannot be factored quickly, consider other RSA vulnerabilities, especially if `e` or `d` exhibit unusual characteristics.
- **Wiener's Attack for small `d`:** Even if `e` is very large, `d` can still be small if `p` and `q` are chosen imbalancedly, which is an ideal condition for Wiener's Attack.
- **Power of specialized tools:** Tools like `RsaCtfTool` or online services like `dcode.fr` are highly effective at automating known RSA attack methods, saving
significant time in CTFs. Always having such a "Swiss Army knife" in
one's toolkit is crucial.
- **Category:** Crypto
- **Tags:** RSA, Wiener's Attack, Factoring, Python

---

# TIẾNG VIỆT

## 1. Challenge Summary

Challenge cung cấp ba tham số cơ bản của RSA: modulus `n`, public exponent `e`, và ciphertext `c` trong một file văn bản. Nhiệm vụ là giải mã `c` để tìm ra flag.

---

## 2. Initial Analysis & Reconnaissance

Ta đã được cung cấp các giá trị `n`, `e`, `c`. Bước đầu tiên là thử phân tích thừa số `n` thành hai số nguyên tố `p` và `q` bằng cách sử dụng Factordb, đây là phương pháp tiêu chuẩn cho các bài RSA đơn giản. Tuy nhiên, `n` khá lớn và Factordb không thể tìm thấy các thừa số.

```
[*] Đang thử phân tích n: 30610867131545893573245403370929044810375908252345734515216335567761070674235240557970829245356614030481955825874376565524126172250295479286829004996105122106474627414932278394880727207687247106535964451736524423676062227917939094755601312619938974463767105253817030590414646900543888347805544511989816392901347341338737906837896070023751031260815782973250734600300683094949304509692321753534435264794596296780586539085130232106649876660029506699244567866816756904364396378546670735017278059889632347338673055259053699246622809620909022329749464060132071464884484682112534813343645706384624586841979729464134335809829
[-] Không tìm thấy hai thừa số nguyên tố cho n từ Factordb.

```

---

## 3. The Vulnerability

Khi `n` không thể phân tích thừa số dễ dàng bằng các 
phương pháp thông thường, chúng ta cần xem xét các điểm yếu khác trong 
việc tạo khóa RSA. Với giá trị `e` (public exponent) rất lớn, điều này thường là dấu hiệu của một `d` (private exponent) nhỏ. Đây là kịch bản cổ điển cho **Wiener's Attack**, một kỹ thuật tấn công RSA dựa trên chuỗi liên tục (continued fractions) để tìm `d` khi `d` có giá trị nhỏ (ref: `4_Aurelinth_CRYPTO.md` (Section: C_Attack_RSA)).

---

## 4. Exploitation Steps

1. Ban đầu, đã thử phân tích `n` bằng Factordb nhưng không thành công.
2. Với `n` lớn và `e` cũng rất lớn, giả thuyết được đặt ra là `d` có thể nhỏ, đây là điều kiện để tấn công Wiener's.
3. Thay vì cố gắng code tay hoặc dùng `RsaCtfTool` (sau khi đã gặp lỗi về đường dẫn), một công cụ giải mã RSA trực tuyến tại `dcode.fr` đã được sử dụng.
4. Nhập các giá trị `N`, `E`, `C` vào trang web `dcode.fr`.
5. Công cụ đã tự động nhận diện và áp dụng thành công Wiener's Attack. Nó tính toán được `p`, `q` từ `N` và `E`, sau đó tìm ra `D`.
6. Cuối cùng, `dcode.fr` đã dùng `C`, `D`, `N` để giải mã tin nhắn, tiết lộ flag.

---

## 5. Final Exploit / Payload

**Input Parameters:**

- `n =
30610867131545893573245403370929044810375908252345734515216335567761070674235240557970829245356614030481955825874376565524126172250295479286829004996105122106474627414932278394880727207687247106535964451736524423676062227917939094755601312619938974463767105253817030590414646900543888347805544511989816392901347341338737906837896070023751031260815782973250734600300683094949304509692321753534435264794596296780586539085130232106649876660029506699244567866816756904364396378546670735017278059889632347338673055259053699246622809620909022329749464060132071464884484682112534813343645706384624586841979729464134335809829`
- `e =
13118943056376811531390887158969590633018246393862457649378429529040458860386531667701783962295691727349409639660447099510339788107269491122926716426902195188489126034970976454948883089008820188515413336458510467289740954821973897752400562551402417627328759394493013110177705814518809291916661933709921311243284600780240090861401353930215487292827235572235250164436683130292475464090785626013810206032736933354696930489144983575446495078404329829091193678240029445525658582548485531996972340914370823232033916046942293331266006647674886928834212203547468218609381456317192256524737280398698305720035095438106008915543`
- `c =
18491889164810617543569456750416875989184817880137548014973592642069416208831086398288449741333647958301433206462225905089767171227296166302076329585813204145393998300807912284373441125769784091235480355305999860836226228064817001671079683866140595167104080925862489688205706558563994071054217252661751197090938128540101902284587959897970686920835999487758527543265902558413502613239565915919268373782402562042295965144636399280059309987259722405692758942811072888497222424752062745376152606372092707679048892146955016482797824514120865462676167840311292744307891590740707933408465096337716317714272609074408402855672`

**Flag:**`QnQSec{I_l0v3_Wi3n3r5_@nD_i_l0v3_Nut5!!!!}`

---

## 6. Key Takeaways & Lessons Learned

- **Không phải lúc nào cũng phân tích thừa số `n`:** Khi `n` quá lớn hoặc không tìm được thừa số nhanh chóng, hãy nghĩ đến các lỗ hổng khác của RSA, đặc biệt là khi `e` hoặc `d` có những đặc điểm bất thường.
- **Wiener's Attack cho `d` nhỏ:** Dù `e` có thể rất lớn, `d` vẫn có thể nhỏ nếu `p` và `q` được chọn không cân bằng, đây là điều kiện lý tưởng cho Wiener's Attack.
- **Sức mạnh của công cụ chuyên dụng:** Các công cụ như `RsaCtfTool` hoặc các dịch vụ trực tuyến như `dcode.fr` rất hiệu quả trong việc tự động hóa các phương pháp tấn công RSA đã
biết, giúp tiết kiệm thời gian đáng kể trong CTF. Luôn có một "Swiss
Army knife" như vậy trong "túi đồ" của mình là rất quan trọng.
